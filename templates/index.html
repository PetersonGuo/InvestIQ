<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Quant AI App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        h1, h2, h3 {
            color: #333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }
        th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #f2f2f2;
        }
        .container {
            width: 80%;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Stock and Options Price Predictor</h1>
        <form method="post" action="/predict">
            <label for="ticker">Ticker Symbol:</label>
            <input type="text" id="ticker" name="ticker" required><br><br>
            <input type="submit" value="Predict">
        </form>
        {% if prediction_text %}
            <h2>{{ prediction_text }}</h2>
        {% endif %}
        {% if prediction_range %}
            <h3>{{ prediction_range }}</h3>
        {% endif %}
        {% if options_data %}
            <h3>Options Data:</h3>
            {% for option in options_data %}
                <h4>Expiration Date: {{ option.expirationDate }}</h4>
                <table>
                    <tr>
                        <th colspan="7">Calls</th>
                        <th colspan="7">Puts</th>
                    </tr>
                    <tr>
                        <th>Strike</th>
                        <th>Last Price</th>
                        <th>Bid</th>
                        <th>Ask</th>
                        <th>Change</th>
                        <th>Volume</th>
                        <th>Open Interest</th>
                        <th>Strike</th>
                        <th>Last Price</th>
                        <th>Bid</th>
                        <th>Ask</th>
                        <th>Change</th>
                        <th>Volume</th>
                        <th>Open Interest</th>
                    </tr>
                    {% set calls = option.calls %}
                    {% set puts = option.puts %}
                    {% for i in range(calls|length) %}
                        <tr>
                            {% if i < calls|length %}
                                <td>{{ calls[i].strike }}</td>
                                <td>{{ calls[i].lastPrice }}</td>
                                <td>{{ calls[i].bid }}</td>
                                <td>{{ calls[i].ask }}</td>
                                <td>{{ calls[i].change }}</td>
                                <td>{{ calls[i].volume }}</td>
                                <td>{{ calls[i].openInterest }}</td>
                            {% else %}
                                <td colspan="7"></td>
                            {% endif %}
                            {% if i < puts|length %}
                                <td>{{ puts[i].strike }}</td>
                                <td>{{ puts[i].lastPrice }}</td>
                                <td>{{ puts[i].bid }}</td>
                                <td>{{ puts[i].ask }}</td>
                                <td>{{ puts[i].change }}</td>
                                <td>{{ puts[i].volume }}</td>
                                <td>{{ puts[i].openInterest }}</td>
                            {% else %}
                                <td colspan="7"></td>
                            {% endif %}
                        </tr>
                    {% endfor %}
                </table>
            {% endfor %}
        {% endif %}
        {% if news_data %}
            <h3>Recent News:</h3>
            <ul>
                {% for article in news_data %}
                    <li>
                        <a href="{{ article.link }}" target="_blank">{{ article.title }}</a><br>
                        {{ article.publisher }} - {{ article.date }}<br>
                        Sentiment: 
                        {% if article.sentiment > 0 %}
                            Positive
                        {% elif article.sentiment < 0 %}
                            Negative
                        {% else %}
                            Neutral
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        {% endif %}
        {% if economic_events %}
            <h3>Upcoming Economic Events:</h3>
            <ul>
                {% for date, event in economic_events %}
                    <li>{{ date }}: {{ event }}</li>
                {% endfor %}
            </ul>
        {% endif %}
        {% if additional_info %}
            <h3>Additional Information:</h3>
            <table>
                {% for key, value in additional_info.items() %}
                    <tr>
                        <th>{{ key }}</th>
                        <td>{{ value }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% endif %}
        {% if additional_info.recommendations %}
            <h3>Analyst Recommendations:</h3>
            <table>
                <tr>
                    <th>Period</th>
                    <th>Strong Buy</th>
                    <th>Buy</th>
                    <th>Hold</th>
                    <th>Sell</th>
                    <th>Strong Sell</th>
                </tr>
                {% for recommendation in additional_info.recommendations %}
                    <tr>
                        <td>{{ recommendation.period }}</td>
                        <td>{{ recommendation.strongBuy }}</td>
                        <td>{{ recommendation.buy }}</td>
                        <td>{{ recommendation.hold }}</td>
                        <td>{{ recommendation.sell }}</td>
                        <td>{{ recommendation.strongSell }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% endif %}
        {% if additional_info.upgrades_downgrades %}
            <h3>Upgrades and Downgrades:</h3>
            <table>
                <tr>
                    <th>Action</th>
                    <th>Firm</th>
                    <th>From</th>
                    <th>To</th>
                </tr>
                {% for upgrade_downgrade in additional_info.upgrades_downgrades %}
                    <tr>
                        <td>{{ upgrade_downgrade.Action }}</td>
                        <td>{{ upgrade_downgrade.Firm }}</td>
                        <td>{{ upgrade_downgrade.FromGrade }}</td>
                        <td>{{ upgrade_downgrade.ToGrade }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% endif %}
        {% if additional_info.insider_roster_holders %}
            <h3>Insider Ownership:</h3>
            <table>
                <tr>
                    <th>Owner</th>
                    <th>Position</th>
                    <th>Most Recent Transaction</th>
                    <th>Latest Transaction Date</th>
                    <th>Shares</th>
                </tr>
                {% for owner in additional_info.insider_roster_holders %}
                    <tr>
                        <td>{{ owner.Name }}</td>
                        <td>{{ owner.Position }}</td>
                        <td>{{ owner['Most Recent Transaction'] }}</td>
                        <td>{{ owner['Latest Transaction Date'] }}</td>
                        <td>{{ owner['Shares Owned Directly'] }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% endif %}
        {% if additional_info.institutional_holders %}
            <h3>Institutional Ownership:</h3>
            <table>
                <tr>
                    <th>Date Reported</th>
                    <th>Owner</th>
                    <th>pctHeld</th>
                    <th>Shares</th>
                    <th>Value</th>
                    <th>Ownership</th>
                </tr>
                {% for owner in additional_info.institutional_holders %}
                    <tr>
                        <td>{{ owner['Date Reported'] }}</td>
                        <td>{{ owner.Holder }}</td>
                        <td>{{ owner.pctHeld }}</td>
                        <td>{{ owner.Shares }}</td>
                        <td>{{ owner.Value }}</td>
                        <td>{{ owner.Ownership }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% endif %}
        {% if additional_info.insider_transactions %}
            <h3>Insider Transactions:</h3>
            <table>
                <tr>
                    <th>Date</th>
                    <th>Transaction</th>
                    <th>Value</th>
                    <th>Shares</th>
                    <th>Filer</th>
                    <th>Position</th>
                </tr>
                {% for transaction in additional_info.insider_transactions %}
                    <tr>
                        <td>{{ transaction['Start Date'] }}</td>
                        <td>{{ transaction.Text }}</td>
                        <td>{{ transaction.Value }}</td>
                        <td>{{ transaction.Shares }}</td>
                        <td>{{ transaction.Insider }}</td>
                        <td>{{ transaction.Position }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% endif %}
    </div>
</body>
</html>
